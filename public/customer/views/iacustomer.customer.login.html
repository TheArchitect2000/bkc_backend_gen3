<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <title>Sign In to BKC Control Panel </title>
    <!-- Favicon-->
    <!--<link rel="icon" href="../../favicon.ico" type="image/x-icon">-->

    <!-- Google Fonts -->
    <!--<link href="https://fonts.googleapis.com/css?family=Roboto:400,700&subset=latin,cyrillic-ext" rel="stylesheet" type="text/css">-->

    <!--material fonts-->
    <!--<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" type="text/css">-->
    <link href="/share/material-icons/material-design-icons.css" rel="stylesheet" type="text/css">

    <!--mdi fonts-->
    <!--<link rel="stylesheet" href="//cdn.materialdesignicons.com/3.6.95/css/materialdesignicons.min.css">-->
    <link rel="stylesheet" href="/share/mdi/css/materialdesignicons.min.css">

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#F44336">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#F44336">
    <!-- iOS Safari -->
    <link rel="apple-touch-icon" href="images/iasign.png">
    <meta name="apple-mobile-web-app-status-bar-style" content="#F44336">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <title>BKC Control Panel</title>
    <!-- Favicon-->
    <link rel="icon" href="/share/IA.ico" type="image/x-icon">


    <!-- Bootstrap Core Css -->
    <link href="/share/plugins/bootstrap/css/bootstrap.css" rel="stylesheet">

    <!-- Waves Effect Css -->
    <link href="/share/plugins/node-waves/waves.css" rel="stylesheet"/>

    <!-- Animation Css -->
    <link href="/share/plugins/animate-css/animate.css" rel="stylesheet"/>

    <!-- Custom Css -->
    <!--<link href="/share/css/style.css" rel="stylesheet">-->
    <link href="/share/css/style-x2.css" rel="stylesheet">

<!--    PWA-->
    <link rel="manifest" href="/iapanelmanifest.json">

    <style>
        html, body {
            height: 100%;
        }

        body > div.row {
            height: 100%;
            display: -webkit-flexbox;
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            -webkit-flex-align: center;
            -ms-flex-align: center;
            -webkit-align-items: center;
            align-items: center;
            justify-content: center;
        }

        .card, .body {
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            border-radius: .5pc;
        }
        input {
            text-indent: .5pc;
        }
        @media (max-width: 767px) {
            .card, .body {
                box-shadow: none;
            }

            .footer {
                border-top: 1px solid grey;
            }
        }
    </style>
</head>

<body class="container">
<div class="row ">
    <div class="col-sm-offset-1  col-sm-4 hidden-xs" >
        <img class="img-responsive" ssbind="src:'../../share/images/logo-'+whichserver+'.png'" style="min-width: 200px">
        <br><br>
<!--        <center><a target="_blank" href="#iaaddress" class="col-red b-1 " style="padding: .4pc; border-radius: 1pc"><b><nobr>Go to <span ssbind="text:domainName"></span> Website</nobr></b></a></center>-->
    </div>

    <div class="col-sm-offset-1 col-sm-5 ">
        <div class="card" style=" min-width: 300px; max-width: 390px">
            <div class="col-sm-12 visible-xs " >
                <img class="img-responsive" ssbind="src:'../../share/images/logo-h-'+whichserver+'.png'" src="../../share/images/ia_logo_h.png" >
            </div>
            <div class="body">
                <div class="m-b-20 ia-bigger-title col-red align-center"><nobr>BKC Control Panel</nobr></div>
                <form id="sign_in" method="POST" action="/customer/">
                    <div class="input-group">
                        <span class="ia-big-title">Email</span>
                        <div class="form-line">
                            <input type="email" class="form-control b-1" name="username" id="username" placeholder="Email address" required onchange="this.value=this.value.trim().toLowerCase()"
                                   autofocus>
                        </div>
                    </div>
                    <div class="input-group">
                        <span class="ia-big-title">Password</span>
                        <div class="form-line">
                            <input type="password" class="form-control b-1" name="password" placeholder="Password" required>
                        </div>
                    </div>
                    <div class="">
                        <span class="hidden-xs" ssifxx="$.cookie('hasvendorb')">
                            <input type="checkbox" id="vendorlogin" name="vendorlogin" class="filled-in chk-col-red"><label for="vendorlogin">Login to vendor panel</label>
                        </span>
                        <button class="btn btn-block bg-red waves-effect ia-bigger-title" type="submit">Sign in</button>
                    </div>
                    <div class="p-t-20">
                        <a href="#" onclick="forgotpassword_mode()" class="col-red">Forgot Password ?</a>
                    </div>

                </form>

                <form id="forgot" class="collapse">

                    <div class="input-group">
                        <span class="ia-big-title">Email</span>
                        <div class="form-line">
                            <input type="email" class="form-control b-1" name="username" placeholder="Email address" required onchange="this.value=this.value.trim().toLowerCase()"
                                   autofocus>
                        </div>
                    </div>
                    <div class="m-b-30">
                        Enter your email address that you used to register. Weâ€™ll send you an email to reset your password.
                    </div>
                    <!--<div class="input-group">
                        <span class="ia-big-title">Password</span>
                        <div class="form-line">
                            <input type="password" class="form-control b-1" name="password" placeholder="Password" required>
                        </div>
                    </div>-->
                    <div class="">
                        <button class="btn btn-block bg-red waves-effect ia-bigger-title" type="button" onclick="resetpassword()">Reset My Password</button>
                    </div>
                    <div class="p-t-20">
                        <!--<input type="checkbox" name="rememberme" id="rememberme" class="filled-in chk-col-deep-orange">
                        <label for="rememberme">Remember Me</label>
                        <br>-->
                        <a href="#" onclick="sign_in_mode()" class="col-red">Back to login</a>
                    </div>
                </form>

                <div id="message" class=" m-t-10"></div>
            </div>
            <div class="footer" >
                <div class="align-center p-b-10 p-t-10">
                    <a href="/customer/views/iacustomer.customer.signup.html" class="col-red">Create New Account</a>
                    <br>
<!--                    <a target="_blank" href="#iaaddress" class="col-red b-1 m-t-20 visible-xs" style="padding: .4pc; border-radius: 1pc"><b><nobr>Go to <span ssbind="text:domainName"></span> Website</nobr></b></a>-->
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Jquery Core Js -->
<script src="/share/plugins/jquery/jquery.min.js"></script>

<!--which-->
<script src="/share/js/which.server.js" ></script>
<!--configs-->
<script src="/share/js/configs.js"></script>
<!--ssbind-->
<script src="/share/js/ssbind.js"></script>
<!--cookie-->
<script src="/share/plugins/jquery-cookie/jquery.cookie.js" ></script>

<!-- Bootstrap Core Js -->
<!--<script src="../../plugins/bootstrap/js/bootstrap.js"></script>-->

<!-- Waves Effect Plugin Js -->
<!--<script src="../../plugins/node-waves/waves.js"></script>-->

<!-- Validation Plugin Js -->
<!--<script src="../../plugins/jquery-validation/jquery.validate.js"></script>-->

<!-- Custom Js -->
<!--<script src="../../js/admin.js"></script>-->
<!--<script src="../../js/pages/examples/sign-in.js"></script>-->
<!--detect device info-->
<script>
    $("#sign_in").submit(function (e) {
        $('#message').html("<i class='mdi mdi-loading mdi-spin'></i>");
        e.preventDefault();
        var formData = $(this).serialize();//new FormData(form);
        if(vendorlogin){
            formData.append("vendorlogin", true);
        }
        $.ajax({
            type: "POST",
            url: "/customer/",
            data: formData,
//            processData: false,
//            contentType: false,
            /*xhr: function(){
                var xhr = new window.XMLHttpRequest();
                var classnew = '';
                var classold = 'mdi-hexagon-outline';

                // Handle progress
                //Upload progress
                xhr.upload.addEventListener("progress", function(evt){
                    if (evt.lengthComputable) {
                        var hex = Math.round((evt.loaded*6) / evt.total);
                        classnew = 'mdi-hexagon-slice-'+hex;
                        if(hex===0) classnew = 'mdi-hexagon-outline';
                        $('#UPLD-btn').removeClass(classold).addClass(classnew);
                        classold = classnew;
                        console.log(hex);
                    }
                }, false);
                //Download progress
                xhr.addEventListener("progress", function(evt){
                    if (evt.lengthComputable) {
                        var percentComplete = 'downloaded = '+evt.loaded / evt.total;
                        //Do something with download progress
                        console.log(percentComplete);
                    }
                }, false);

                return xhr;
            },*/
            /*complete:function(){
                UPLD_file.value = '';
                console.log("Request finished.");
                load_sspage($('#UPLD_files'));
                $('#UPLD-size').text('');//Added
                $('#UPLD-file-name').val('').addClass('disabled');
                $('#UPLD-file-name').attr('placeholder',UPLD_placeholder);
                $('#UPLD-duration').val('');
                $('#UPLD-duration-show').text('');
                $('#UPLD-file-label').removeClass('disabled');
                $('#UPLD-btn').removeClass("col-red mdi-hexagon-slice-6").addClass("col-grey disabled UPLICON");
            },*/
            success: function(r){
                console.log(r);
                if(r.success){
                    if(r.redirect){
                        setTimeout(function () {
                            window.location = r.redirect;
                        },1000);
                    }
                }
                /* swal.fire({
                 title: "Done",
                 html: "File uploaded Successfully",
                 //                    timer: 2000,
                 icon: "success",
                 showConfirmButton: true
                 });*/
            },
            error: function (e) {
                $('#message').html("<div class='alert alert-warning'>"+e.responseJSON?e.responseJSON.message:e.response +"</div>");
                setTimeout(function () {
                    $('#message').html('');
                },3000);
                console.error("some error", e.responseJSON?e.responseJSON.message:e.response);
            }
        });
    });

    /*var urlParams = new URLSearchParams(window.location.search);
    var DeviceType = urlParams.get('DeviceType');
    var MacAddress = urlParams.get('MacAddress');
    if(MacAddress && DeviceType){
        localStorage.NewDeviceType = DeviceType;
        localStorage.NewMacAddress = MacAddress;
        window.history.replaceState(null, null, window.location.pathname);
    }

    if(localStorage.NewDeviceType && localStorage.NewMacAddress){
        DeviceType = localStorage.NewDeviceType;
        MacAddress = localStorage.NewMacAddress;
        show_sspage('/customer/views/iadevice.customer.register.view.html', 'ssbindRender();checkhashome();$("#devicecode").val("'+MacAddress+'");$("input[name=devicetype][value='+DeviceType+']").attr("checked", true);$("#devicename").focus()');
    }*/

    var urlParams = new URLSearchParams(window.location.search);
    var vendorlogin = urlParams.has('vendorlogin');

    function forgotpassword_mode() {
        $('form#sign_in').hide();
        $('form#forgot').show();
        $('form#forgot input[name="username"]').val($('form#sign_in input[name="username"]').val())
    }

    function sign_in_mode() {
        $('form#sign_in').show();
        $('form#forgot').hide();
    }

    function resetpassword() {
        if(!forgot.reportValidity()) {
            return;
        }
        $('#message').html("<i class='mdi mdi-loading mdi-spin'></i>");
        var formData = $('form#forgot').serialize();
        $.ajax({
            type: "POST",
            url: "/customer/resetpasswordrequest",
            data: formData,
            success: function(r){
                console.log(r);
                if(r.success){
                    $('form#forgot').hide();
                    $('#message').html("<h5 class='p-t-30 p-l-30 p-b-30 p-r-30 bg-green font-18 font-thin'>A confirmation email has been sent for you to reset your password. <br>To continue, please check your email.</h5>");
                    /*setTimeout(function () {
                        $('#message').html('');
                    },10000);
                    if(r.redirect){
                        window.location = r.redirect;
                    }*/
                }
            },
            error: function (e) {
                $('#message').html("<div class='alert alert-warning'>"+e.responseJSON?e.responseJSON.message:e.response+"</div>");
                setTimeout(function () {
                    $('#message').html('');
                },3000);
                console.error("some error", e.responseJSON?e.responseJSON.message:e.response);
            }
        });
    }

    $('a[href="#iaaddress"]').attr('href', '//'+window.location.hostname.substr(window.location.hostname.indexOf('.')+1))

    ssbindRender();
</script>
</body>

</html>